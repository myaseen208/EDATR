[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Experimental Design and Analysis for tree Improvement using R",
    "section": "",
    "text": "Preface\nThis book contains R codes and tutorials from R package eda4treeR on Experimental Design and Analysis for tree Improvement by E.R. Williams, C.E. Harwood and A.C. Matheson.\nThe development version of R package eda4treeR can be installed from github as follows:\n\nif (!require(\"remotes\")) install.packages(\"remotes\")\nremotes::install_github(\"myaseen208/eda4treeR\")\n\nThe stable version of R package eda4treeR can be installed from CRAN as follows:\n\ninstall.packages(\"eda4treeR\")",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "Ch02.html",
    "href": "Ch02.html",
    "title": "2  Experimental Planning and Layout",
    "section": "",
    "text": "2.1 Example 2.1 (Pg. 24)",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Experimental Planning and Layout</span>"
    ]
  },
  {
    "objectID": "Ch02.html#example-2.1-pg.-24",
    "href": "Ch02.html#example-2.1-pg.-24",
    "title": "2  Experimental Planning and Layout",
    "section": "",
    "text": "Example 2.1 (Pg. 24)\n\n\n\nA field trial was planted to compare a seedlot derived from a seed orchard (SO) with one collected from a routine plantation (P). There were eight plots of each seedlot, thinned at seven years of age. Tree diameters at breast height (dbh) were measured at 15 years and plot means calculated.\n\n\n\n library(car)\n\n library(dae)\n\n library(dplyr)\n\n library(emmeans)\n\n library(ggplot2)\n\n library(lmerTest)\n\n library(magrittr)\n\n library(predictmeans)\n\n data(DataExam2.1)\n\n # Pg. 22\n fmtab2.3  &lt;- lm(formula = dbh ~ seedlot, data = DataExam2.1)\n\n # Pg. 23\n anova(fmtab2.3)\nAnalysis of Variance Table\n\nResponse: dbh\n          Df Sum Sq Mean Sq F value  Pr(&gt;F)  \nseedlot    1  14.27 14.2695  3.2531 0.09284 .\nResiduals 14  61.41  4.3864                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n # Pg. 23\n emmeans(object = fmtab2.3, specs = ~ seedlot)\n seedlot emmean   SE df lower.CL upper.CL\n SO        30.6 0.74 14     29.0     32.2\n P         28.7 0.74 14     27.1     30.3\n\nConfidence level used: 0.95 \n\n emmip(object = fmtab2.3, formula = ~ seedlot) +\n   theme_classic()",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Experimental Planning and Layout</span>"
    ]
  },
  {
    "objectID": "Ch02.html#example-2.2-pg.-26",
    "href": "Ch02.html#example-2.2-pg.-26",
    "title": "2  Experimental Planning and Layout",
    "section": "2.2 Example 2.2 (Pg. 26)",
    "text": "2.2 Example 2.2 (Pg. 26)\n\n\n\n\n\n\nExample 2.2 (Pg. 26)\n\n\n\n\n\n\n library(car)\n\n library(dae)\n\n library(dplyr)\n\n library(emmeans)\n\n library(ggplot2)\n\n library(lmerTest)\n\n library(magrittr)\n\n library(predictmeans)\n\n data(DataExam2.2)\n\n # Pg. 24\n fmtab2.5 &lt;-\n           lm(\n              formula  = dbh ~ block + seedlot\n            , data     = DataExam2.2\n            )\n\n # Pg. 26\n anova(fmtab2.5)\nAnalysis of Variance Table\n\nResponse: dbh\n          Df Sum Sq Mean Sq F value  Pr(&gt;F)  \nblock      7 48.867  6.9810  3.8959 0.04671 *\nseedlot    1 14.270 14.2695  7.9635 0.02570 *\nResiduals  7 12.543  1.7919                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n # Pg. 26\n emmeans(object = fmtab2.5, specs = ~ seedlot)\n seedlot emmean    SE df lower.CL upper.CL\n SO        30.6 0.473  7     29.5     31.7\n P         28.7 0.473  7     27.6     29.8\n\nResults are averaged over the levels of: block \nConfidence level used: 0.95 \n\n emmip(object = fmtab2.5, formula = ~ seedlot) +\n   theme_classic()",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Experimental Planning and Layout</span>"
    ]
  },
  {
    "objectID": "Ch03.html",
    "href": "Ch03.html",
    "title": "3  Data Collection and Pre-Processing",
    "section": "",
    "text": "3.1 Example 3.1 (Pg. 30)",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Data Collection and Pre-Processing</span>"
    ]
  },
  {
    "objectID": "Ch03.html#example-3.1-pg.-30",
    "href": "Ch03.html#example-3.1-pg.-30",
    "title": "3  Data Collection and Pre-Processing",
    "section": "",
    "text": "Example 3.1 (Pg. 30)\n\n\n\nWe illustrate the recommended layout for data sheets with one of the trials conducted by the Australian Centre for International Agricultural Research (ACIAR) in Queensland, Australia (Experiment 309). This was a species trial planted in 1985; survival was poor. For our example we will examine only part of the data from this experiment. Five of the species with good survival have been extracted at random, namely Acacia, Angophora, Casuarina, Melaleuca and Petalostigma.\n\n\n\n library(car)\n\n library(dae)\n\n library(dplyr)\n\n library(emmeans)\n\n library(ggplot2)\n\n library(lmerTest)\n\n library(magrittr)\n\n library(predictmeans)\n\n library(supernova)\n\n data(DataExam3.1)\n\n # Pg. 28\n fmtab3.3 &lt;-\n           lm(\n               formula = ht ~ repl*seedlot\n             , data    = DataExam3.1\n             )\n\n fmtab3.3ANOVA1 &lt;-\n   anova(fmtab3.3) %&gt;%\n   mutate(\n   \"F value\" =\n          c(\n            anova(fmtab3.3)[1:2, 3]/anova(fmtab3.3)[3, 3]\n          , anova(fmtab3.3)[3, 4]\n          , NA\n          )\n           )\n\n  # Pg. 33 (Table 3.3)\n fmtab3.3ANOVA1 %&gt;%\n   mutate(\n   \"Pr(&gt;F)\"  =\n        c(\n          NA\n        , pf(\n             q   = fmtab3.3ANOVA1[2, 4]\n           , df1 = fmtab3.3ANOVA1[2, 1]\n           , df2 = fmtab3.3ANOVA1[3, 1], lower.tail = FALSE\n           )\n        , NA\n        , NA\n        )\n        )\n             Df Sum Sq Mean Sq F value   Pr(&gt;F)   \nrepl          1  20.30  20.301  3.4197            \nseedlot       4 505.87 126.467 21.3035 0.005851 **\nrepl:seedlot  4  23.75   5.936  2.3663            \nResiduals    70 175.61   2.509                    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n  # Pg. 33  (Table 3.3)\n  emmeans(object  = fmtab3.3, specs = ~ seedlot)\n seedlot      emmean    SE df lower.CL upper.CL\n Acacia        10.29 0.396 70     9.50    11.08\n Angophora      7.10 0.396 70     6.31     7.89\n Casuarina      5.51 0.396 70     4.72     6.30\n Melaleuca      4.94 0.396 70     4.15     5.73\n Petalostigma   2.73 0.396 70     1.94     3.52\n\nResults are averaged over the levels of: repl \nConfidence level used: 0.95 \n\n  # Pg. 34  (Figure 3.2)\n  ggplot(\n     mapping = aes(\n                   x = fitted.values(fmtab3.3)\n                 , y = residuals(fmtab3.3)\n                 )\n                 ) +\n  geom_point(size = 2) +\n  labs(\n     x = \"Fitted Values\"\n   , y = \"Residual\"\n    ) +\n  theme_classic()\n\n\n\n\n\n\n\n\n\n\n # Pg. 33 (Table 3.4)\n DataExam3.1m &lt;- DataExam3.1\n\n DataExam3.1m[c(28, 51, 76), 5] &lt;- NA\n\n DataExam3.1m[c(28, 51, 76), 6] &lt;- NA\n\n fmtab3.4 &lt;-\n           lm(\n               formula   = ht ~ repl*seedlot\n             , data      = DataExam3.1m\n             )\n\n fmtab3.4ANOVA1 &lt;-\n   anova(fmtab3.4) %&gt;%\n   mutate(\n       \"F value\" =\n             c(\n                anova(fmtab3.4)[1:2, 3]/anova(fmtab3.4)[3, 3]\n              , anova(fmtab3.4)[3, 4]\n              , NA\n              )\n              )\n\n # Pg. 33 (Table 3.4)\n fmtab3.4ANOVA1 %&gt;%\n   mutate(\n   \"Pr(&gt;F)\"  =\n        c(\n          NA\n        , pf(\n             q   = fmtab3.4ANOVA1[2, 4]\n           , df1 = fmtab3.4ANOVA1[2, 1]\n           , df2 = fmtab3.4ANOVA1[3, 1], lower.tail = FALSE\n           )\n        , NA\n        , NA\n        )\n        )\n             Df Sum Sq Mean Sq F value  Pr(&gt;F)    \nrepl          1  18.88  18.877 10.4201            \nseedlot       4 588.68 147.169 81.2367 0.00044 ***\nrepl:seedlot  4   7.25   1.812  2.4163            \nResiduals    67  50.23   0.750                    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n  # Pg. 33  (Table 3.4)\n  emmeans(object  = fmtab3.4, specs = ~ seedlot)\n seedlot      emmean    SE df lower.CL upper.CL\n Acacia        10.87 0.224 67    10.42    11.31\n Angophora      7.76 0.231 67     7.30     8.22\n Casuarina      5.51 0.216 67     5.08     5.94\n Melaleuca      4.94 0.216 67     4.51     5.38\n Petalostigma   2.73 0.216 67     2.30     3.16\n\nResults are averaged over the levels of: repl \nConfidence level used: 0.95",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Data Collection and Pre-Processing</span>"
    ]
  },
  {
    "objectID": "Ch03.html#example-3.1-continued-pg.-34",
    "href": "Ch03.html#example-3.1-continued-pg.-34",
    "title": "3  Data Collection and Pre-Processing",
    "section": "3.2 Example 3.1 (continued) (Pg. 34)",
    "text": "3.2 Example 3.1 (continued) (Pg. 34)\n\n\n\n\n\n\nExample 3.1 (continued) (Pg. 34)\n\n\n\nThe analysis of variance table for ht is given below:\n\n\n\n library(car)\n\n library(dae)\n\n library(dplyr)\n\n library(emmeans)\n\n library(ggplot2)\n\n library(lmerTest)\n\n library(magrittr)\n\n library(predictmeans)\n\n data(DataExam3.1.1)\n\n # Pg. 36\n fm3.8 &lt;-\n       lm(\n          formula = ht ~ repl + seedlot\n        , data    = DataExam3.1.1\n        )\n\n # Pg. 40\n anova(fm3.8)\nAnalysis of Variance Table\n\nResponse: ht\n          Df Sum Sq Mean Sq F value   Pr(&gt;F)   \nrepl       1  2.538  2.5376  3.4197 0.138108   \nseedlot    4 63.234 15.8084 21.3035 0.005851 **\nResiduals  4  2.968  0.7421                    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n # Pg. 40\n emmeans(object = fm3.8, specs  = ~seedlot)\n seedlot      emmean    SE df lower.CL upper.CL\n Acacia        10.29 0.609  4     8.60    11.98\n Angophora      7.10 0.609  4     5.41     8.79\n Casuarina      5.51 0.609  4     3.82     7.20\n Melaleuca      4.94 0.609  4     3.25     6.63\n Petalostigma   2.73 0.609  4     1.04     4.42\n\nResults are averaged over the levels of: repl \nConfidence level used: 0.95 \n\n emmip(object = fm3.8, formula  = ~seedlot) +\n  theme_classic()",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Data Collection and Pre-Processing</span>"
    ]
  },
  {
    "objectID": "Ch04.html",
    "href": "Ch04.html",
    "title": "4  Experimental Design",
    "section": "",
    "text": "4.1 Example 4.3 (Pg. 53)",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Experimental Design</span>"
    ]
  },
  {
    "objectID": "Ch04.html#example-4.3-pg.-53",
    "href": "Ch04.html#example-4.3-pg.-53",
    "title": "4  Experimental Design",
    "section": "",
    "text": "Example 4.3 (Pg. 53)\n\n\n\nMajor seed distributors such as the Australian Tree Seed Centre (ATSC) routinely conduct seed viability tests so that, when seed is dispatched, the purchaser has an indication of the germination percentage of the seed. As part of the ATSC research program, a series of experiments was conducted in 1992 by Debbie Solomon on provenances of Acacia mangium to investigate methods of pre-treatment and loss of viability of stored seed. Each experiment involved six seedlots of Acacia mangium and four seed pre-treatments in a factorial design with three replicates.\n\n\n\n library(car)\n\n library(dae)\n\n library(dplyr)\n\n library(emmeans)\n\n library(ggplot2)\n\n library(lmerTest)\n\n library(magrittr)\n\n library(predictmeans)\n\n data(DataExam4.3)\n\n  # Pg. 50\n  fm4.2    &lt;-\n    aov(\n        formula =\n        percent ~ repl + contcomp + seedlot +\n                  treat/contcomp + contcomp/seedlot +\n                  treat/contcomp/seedlot\n       , data   = DataExam4.3\n      )\n\n  # Pg. 54\n  anova(fm4.2)\nAnalysis of Variance Table\n\nResponse: percent\n                       Df Sum Sq Mean Sq  F value                Pr(&gt;F)    \nrepl                    2     35      18   0.1804             0.8355379    \ncontcomp                1  58542   58542 601.5217 &lt; 0.00000000000000022 ***\nseedlot                 5   2894     579   5.9481             0.0002538 ***\ntreat                   2   5300    2650  27.2295         0.00000001576 ***\ncontcomp:seedlot        5   1347     269   2.7682             0.0287571 *  \ncontcomp:seedlot:treat 10    961      96   0.9876             0.4674993    \nResiduals              46   4477      97                                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n  # Pg. 54\n  model.tables(x = fm4.2, type = \"means\")\nTables of means\nGrand mean\n         \n51.38889 \n\n repl \n        1     2     3\n    52.33 50.67 51.17\nrep 24.00 24.00 24.00\n\n contcomp \n    Treated control\n      67.85       2\nrep   54.00      18\n\n seedlot \n    18211 18212 18217 18248 18249 18265\n       58 52.33    49 40.67 48.67 59.67\nrep    12 12.00    12 12.00 12.00 12.00\n\n treat \n     nick  bw&s control bw1min\n    40.43 49.31   51.39  64.43\nrep 18.00 18.00   18.00  18.00\n\n contcomp:seedlot \n         seedlot\ncontcomp  18211 18212 18217 18248 18249 18265\n  Treated 77.33 69.33 63.11 53.33 64.89 79.11\n  rep      9.00  9.00  9.00  9.00  9.00  9.00\n  control  0.00  1.33  6.67  2.67  0.00  1.33\n  rep      3.00  3.00  3.00  3.00  3.00  3.00\n\n contcomp:seedlot:treat \n, , treat = nick\n\n         seedlot\ncontcomp  18211 18212 18217 18248 18249 18265\n  Treated 65.33 54.67 57.33 40.00 49.33 74.67\n  rep      3.00  3.00  3.00  3.00  3.00  3.00\n  control                                    \n  rep      0.00  0.00  0.00  0.00  0.00  0.00\n\n, , treat = bw&s\n\n         seedlot\ncontcomp  18211 18212 18217 18248 18249 18265\n  Treated 78.67 68.00 54.67 52.00 61.33 80.00\n  rep      3.00  3.00  3.00  3.00  3.00  3.00\n  control                                    \n  rep      0.00  0.00  0.00  0.00  0.00  0.00\n\n, , treat = control\n\n         seedlot\ncontcomp  18211 18212 18217 18248 18249 18265\n  Treated                                    \n  rep      0.00  0.00  0.00  0.00  0.00  0.00\n  control  0.00  1.33  6.67  2.67  0.00  1.33\n  rep      3.00  3.00  3.00  3.00  3.00  3.00\n\n, , treat = bw1min\n\n         seedlot\ncontcomp  18211 18212 18217 18248 18249 18265\n  Treated 88.00 85.33 77.33 68.00 84.00 82.67\n  rep      3.00  3.00  3.00  3.00  3.00  3.00\n  control                                    \n  rep      0.00  0.00  0.00  0.00  0.00  0.00\n\n\n  emmeans(object = fm4.2, specs = ~ contcomp)\n contcomp emmean   SE df lower.CL upper.CL\n Treated    67.9 1.34 46    65.15    70.55\n control     2.0 2.33 46    -2.68     6.68\n\nResults are averaged over the levels of: repl, seedlot, treat \nConfidence level used: 0.95 \n\n  emmeans(object = fm4.2, specs = ~ seedlot)\n seedlot emmean   SE df lower.CL upper.CL\n 18211     38.7 3.29 46     32.0     45.3\n 18212     35.3 3.29 46     28.7     42.0\n 18217     34.9 3.29 46     28.3     41.5\n 18248     28.0 3.29 46     21.4     34.6\n 18249     32.4 3.29 46     25.8     39.1\n 18265     40.2 3.29 46     33.6     46.8\n\nResults are averaged over the levels of: repl, treat, contcomp \nConfidence level used: 0.95 \n\n  emmeans(object = fm4.2, specs = ~ contcomp + treat)\n treat   contcomp emmean   SE df lower.CL upper.CL\n nick    Treated    56.9 2.33 46    52.21    61.57\n bw&s    Treated    65.8 2.33 46    61.10    70.46\n bw1min  Treated    80.9 2.33 46    76.21    85.57\n control control     2.0 2.33 46    -2.68     6.68\n\nResults are averaged over the levels of: repl, seedlot \nConfidence level used: 0.95 \n\n  emmeans(object = fm4.2, specs = ~ contcomp + seedlot)\n contcomp seedlot emmean   SE df lower.CL upper.CL\n Treated  18211    77.33 3.29 46     70.7     84.0\n control  18211     0.00 5.70 46    -11.5     11.5\n Treated  18212    69.33 3.29 46     62.7     76.0\n control  18212     1.33 5.70 46    -10.1     12.8\n Treated  18217    63.11 3.29 46     56.5     69.7\n control  18217     6.67 5.70 46     -4.8     18.1\n Treated  18248    53.33 3.29 46     46.7     60.0\n control  18248     2.67 5.70 46     -8.8     14.1\n Treated  18249    64.89 3.29 46     58.3     71.5\n control  18249     0.00 5.70 46    -11.5     11.5\n Treated  18265    79.11 3.29 46     72.5     85.7\n control  18265     1.33 5.70 46    -10.1     12.8\n\nResults are averaged over the levels of: repl, treat \nConfidence level used: 0.95 \n\n  emmeans(object = fm4.2, specs = ~ contcomp + treat + seedlot)\n treat   contcomp seedlot emmean  SE df lower.CL upper.CL\n nick    Treated  18211    65.33 5.7 46     53.9     76.8\n bw&s    Treated  18211    78.67 5.7 46     67.2     90.1\n bw1min  Treated  18211    88.00 5.7 46     76.5     99.5\n control control  18211     0.00 5.7 46    -11.5     11.5\n nick    Treated  18212    54.67 5.7 46     43.2     66.1\n bw&s    Treated  18212    68.00 5.7 46     56.5     79.5\n bw1min  Treated  18212    85.33 5.7 46     73.9     96.8\n control control  18212     1.33 5.7 46    -10.1     12.8\n nick    Treated  18217    57.33 5.7 46     45.9     68.8\n bw&s    Treated  18217    54.67 5.7 46     43.2     66.1\n bw1min  Treated  18217    77.33 5.7 46     65.9     88.8\n control control  18217     6.67 5.7 46     -4.8     18.1\n nick    Treated  18248    40.00 5.7 46     28.5     51.5\n bw&s    Treated  18248    52.00 5.7 46     40.5     63.5\n bw1min  Treated  18248    68.00 5.7 46     56.5     79.5\n control control  18248     2.67 5.7 46     -8.8     14.1\n nick    Treated  18249    49.33 5.7 46     37.9     60.8\n bw&s    Treated  18249    61.33 5.7 46     49.9     72.8\n bw1min  Treated  18249    84.00 5.7 46     72.5     95.5\n control control  18249     0.00 5.7 46    -11.5     11.5\n nick    Treated  18265    74.67 5.7 46     63.2     86.1\n bw&s    Treated  18265    80.00 5.7 46     68.5     91.5\n bw1min  Treated  18265    82.67 5.7 46     71.2     94.1\n control control  18265     1.33 5.7 46    -10.1     12.8\n\nResults are averaged over the levels of: repl \nConfidence level used: 0.95 \n\n  DataExam4.3 %&gt;%\n    dplyr::group_by(treat, contcomp, seedlot) %&gt;%\n    dplyr::summarize(Mean = mean(percent))\n# A tibble: 24 × 4\n# Groups:   treat, contcomp [4]\n   treat contcomp seedlot  Mean\n   &lt;fct&gt; &lt;fct&gt;    &lt;fct&gt;   &lt;dbl&gt;\n 1 nick  Treated  18211    65.3\n 2 nick  Treated  18212    54.7\n 3 nick  Treated  18217    57.3\n 4 nick  Treated  18248    40  \n 5 nick  Treated  18249    49.3\n 6 nick  Treated  18265    74.7\n 7 bw&s  Treated  18211    78.7\n 8 bw&s  Treated  18212    68  \n 9 bw&s  Treated  18217    54.7\n10 bw&s  Treated  18248    52  \n# ℹ 14 more rows\n\n    RESFIT &lt;-\n           data.frame(\n            residualvalue = residuals(fm4.2)\n          , fittedvalue   = fitted.values(fm4.2)\n          )\n\n    ggplot(mapping = aes(\n                          x = fitted.values(fm4.2)\n                        , y = residuals(fm4.2))) +\n    geom_point(size = 2) +\n    labs(\n        x = \"Fitted Values\"\n      , y = \"Residuals\"\n      ) +\n      theme_classic()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nHere the control pre-treatment was deleted.\n\n\n\n library(car)\n\n library(dae)\n\n library(dplyr)\n\n library(emmeans)\n\n library(ggplot2)\n\n library(lmerTest)\n\n library(magrittr)\n\n library(predictmeans)\n\n data(DataExam4.3)\n\n # Pg. 57\n fm4.4    &lt;-\n   aov(\n       formula = percent ~ repl + treat*seedlot\n     , data    = DataExam4.3 %&gt;%\n                  filter(treat != \"control\")\n      )\n\n  # Pg. 57\n  anova(fm4.4)\nAnalysis of Variance Table\n\nResponse: percent\n              Df Sum Sq Mean Sq F value      Pr(&gt;F)    \nrepl           2   64.6   32.30  0.2511   0.7793606    \ntreat          2 5300.1 2650.07 20.6055 0.000001375 ***\nseedlot        5 4148.1  829.63  6.4507   0.0002578 ***\ntreat:seedlot 10  961.2   96.12  0.7474   0.6759614    \nResiduals     34 4372.7  128.61                        \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n  model.tables(x = fm4.4, type = \"means\", se = TRUE)\nTables of means\nGrand mean\n         \n67.85185 \n\n repl \nrepl\n    1     2     3 \n69.11 66.44 68.00 \n\n treat \ntreat\n  nick   bw&s bw1min \n 56.89  65.78  80.89 \n\n seedlot \nseedlot\n18211 18212 18217 18248 18249 18265 \n77.33 69.33 63.11 53.33 64.89 79.11 \n\n treat:seedlot \n        seedlot\ntreat    18211 18212 18217 18248 18249 18265\n  nick   65.33 54.67 57.33 40.00 49.33 74.67\n  bw&s   78.67 68.00 54.67 52.00 61.33 80.00\n  bw1min 88.00 85.33 77.33 68.00 84.00 82.67\n\nStandard errors for differences of means\n         repl treat seedlot treat:seedlot\n        3.780 3.780   5.346         9.260\nreplic.    18    18       9             3\n\n  emmeans(object = fm4.4, specs = ~ treat)\n treat  emmean   SE df lower.CL upper.CL\n nick     56.9 2.67 34     51.5     62.3\n bw&s     65.8 2.67 34     60.3     71.2\n bw1min   80.9 2.67 34     75.5     86.3\n\nResults are averaged over the levels of: repl, seedlot \nConfidence level used: 0.95 \n\n  emmeans(object = fm4.4, specs = ~ seedlot)\n seedlot emmean   SE df lower.CL upper.CL\n 18211     77.3 3.78 34     69.7     85.0\n 18212     69.3 3.78 34     61.7     77.0\n 18217     63.1 3.78 34     55.4     70.8\n 18248     53.3 3.78 34     45.7     61.0\n 18249     64.9 3.78 34     57.2     72.6\n 18265     79.1 3.78 34     71.4     86.8\n\nResults are averaged over the levels of: repl, treat \nConfidence level used: 0.95 \n\n  emmeans(object = fm4.4, specs = ~ treat * seedlot)\n treat  seedlot emmean   SE df lower.CL upper.CL\n nick   18211     65.3 6.55 34     52.0     78.6\n bw&s   18211     78.7 6.55 34     65.4     92.0\n bw1min 18211     88.0 6.55 34     74.7    101.3\n nick   18212     54.7 6.55 34     41.4     68.0\n bw&s   18212     68.0 6.55 34     54.7     81.3\n bw1min 18212     85.3 6.55 34     72.0     98.6\n nick   18217     57.3 6.55 34     44.0     70.6\n bw&s   18217     54.7 6.55 34     41.4     68.0\n bw1min 18217     77.3 6.55 34     64.0     90.6\n nick   18248     40.0 6.55 34     26.7     53.3\n bw&s   18248     52.0 6.55 34     38.7     65.3\n bw1min 18248     68.0 6.55 34     54.7     81.3\n nick   18249     49.3 6.55 34     36.0     62.6\n bw&s   18249     61.3 6.55 34     48.0     74.6\n bw1min 18249     84.0 6.55 34     70.7     97.3\n nick   18265     74.7 6.55 34     61.4     88.0\n bw&s   18265     80.0 6.55 34     66.7     93.3\n bw1min 18265     82.7 6.55 34     69.4     96.0\n\nResults are averaged over the levels of: repl \nConfidence level used: 0.95",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Experimental Design</span>"
    ]
  },
  {
    "objectID": "Ch04.html#example-4.4-pg.-61",
    "href": "Ch04.html#example-4.4-pg.-61",
    "title": "4  Experimental Design",
    "section": "4.2 Example 4.4 (Pg. 61)",
    "text": "4.2 Example 4.4 (Pg. 61)\n\n\n\n\n\n\nExample 4.4 (Pg. 61)\n\n\n\nAn experiment supported by the Shell Company was planted at Toolara Forest Reserve near Gympie, Queensland, in February 1987 to study the effects of irrigation and fertiliser on four seedlots of Eucalyptus grandis. Because of the difficulty in applying the irrigation and fertiliser treatments individually to each 7 \\(\\times\\) 6 plot of trees, the experiment was designed as a split-plot, with main-plot treatments, irrig and fert. There were two replicates of four main-plots each with four sub-plots.\n\n\n\n library(car)\n\n library(dae)\n\n library(dplyr)\n\n library(emmeans)\n\n library(ggplot2)\n\n library(lmerTest)\n\n library(magrittr)\n\n library(predictmeans)\n\n data(DataExam4.4)\n\n # Pg. 58\n fm4.6    &lt;-\n   aov(\n       formula = height ~ repl + irrig*fert*seedlot +\n                          Error(repl/irrig:fert)\n     , data    = DataExam4.4\n     )\n\n # Pg. 61\n  summary(fm4.6)\n\nError: repl\n     Df Sum Sq Mean Sq\nrepl  1 0.7564  0.7564\n\nError: repl:irrig:fert\n           Df Sum Sq Mean Sq F value  Pr(&gt;F)    \nirrig       1    0.1     0.1   0.154   0.721    \nfert        1  590.6   590.6 841.110 0.00009 ***\nirrig:fert  1    0.0     0.0   0.010   0.926    \nResiduals   3    2.1     0.7                    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nError: Within\n                   Df Sum Sq Mean Sq F value   Pr(&gt;F)    \nseedlot             3  39.65  13.218  19.680 0.000063 ***\nirrig:seedlot       3   1.11   0.370   0.551   0.6572    \nfert:seedlot        3   9.95   3.317   4.938   0.0185 *  \nirrig:fert:seedlot  3   1.74   0.579   0.862   0.4874    \nResiduals          12   8.06   0.672                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n # Pg. 61\n model.tables(x = fm4.6, type = \"means\")\nTables of means\nGrand mean\n         \n10.00437 \n\n repl \nrepl\n     1      2 \n10.158  9.851 \n\n irrig \nirrig\n  none   plus \n 9.946 10.062 \n\n fert \nfert\n  none   plus \n 5.708 14.301 \n\n seedlot \nseedlot\n Bulahdelah    Coffs SO Pomona pltn    Atherton \n     10.178      11.404      10.149       8.287 \n\n irrig:fert \n      fert\nirrig  none   plus  \n  none  5.635 14.257\n  plus  5.781 14.344\n\n irrig:seedlot \n      seedlot\nirrig  Bulahdelah Coffs SO Pomona pltn Atherton\n  none 10.060     11.647   10.055       8.022  \n  plus 10.295     11.160   10.242       8.552  \n\n fert:seedlot \n      seedlot\nfert   Bulahdelah Coffs SO Pomona pltn Atherton\n  none  5.687      6.790    5.410       4.945  \n  plus 14.667     16.017   14.887      11.630  \n\n irrig:fert:seedlot \n, , seedlot = Bulahdelah\n\n      fert\nirrig  none   plus  \n  none  5.275 14.845\n  plus  6.100 14.490\n\n, , seedlot = Coffs SO\n\n      fert\nirrig  none   plus  \n  none  7.125 16.170\n  plus  6.455 15.865\n\n, , seedlot = Pomona pltn\n\n      fert\nirrig  none   plus  \n  none  5.625 14.485\n  plus  5.195 15.290\n\n, , seedlot = Atherton\n\n      fert\nirrig  none   plus  \n  none  4.515 11.530\n  plus  5.375 11.730\n\n\n # Pg. 61\n emmeans(object = fm4.6, specs = ~ irrig)\n irrig emmean  SE  df asymp.LCL asymp.UCL\n none    9.95 NaN NaN       NaN       NaN\n plus   10.06 NaN NaN       NaN       NaN\n\nResults are averaged over the levels of: repl, fert, seedlot \nWarning: EMMs are biased unless design is perfectly balanced \nConfidence level used: 0.95 \n\n emmip(object = fm4.6, formula  = ~ irrig) +\n     theme_classic()",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Experimental Design</span>"
    ]
  },
  {
    "objectID": "Ch05.html",
    "href": "Ch05.html",
    "title": "5  Analysis Across Sites",
    "section": "",
    "text": "5.1 Example 5.1 (Pg. 68)",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Analysis Across Sites</span>"
    ]
  },
  {
    "objectID": "Ch05.html#example-5.1-pg.-68",
    "href": "Ch05.html#example-5.1-pg.-68",
    "title": "5  Analysis Across Sites",
    "section": "",
    "text": "Example 5.1 (Pg. 68)\n\n\n\nIn 1985 species/provenance trials were laid out at six sites in Thailand as part of an ACIAR project extending over several years to investigate Australian multi-purpose tree species. The experimental design in each case was an RCB design with three replicates and the number of seedlots ranged from 30 to 42. Plots consisted of 5 \\(\\times\\) 5 trees with a 2m \\(\\times\\) 2m spacing. Plot summary files were constructed for the 24-month measurement according to the methods described in Chapter 3. Analyses were performed on the plot mean data at each site.\n\n\n\n library(car)\n\n library(dae)\n\n library(dplyr)\n\n library(emmeans)\n\n library(ggplot2)\n\n library(lmerTest)\n\n library(magrittr)\n\n library(predictmeans)\n\n data(DataExam5.1)\n\n # Pg.68\n fm5.4 &lt;-\n       lm(\n           formula = ht ~ site*seedlot\n         , data    = DataExam5.1\n         )\n\n # Pg. 73\n anova(fm5.4)\nAnalysis of Variance Table\n\nResponse: ht\n             Df  Sum Sq Mean Sq F value Pr(&gt;F)\nsite          3  919585  306528     NaN    NaN\nseedlot      26 3176289  122165     NaN    NaN\nsite:seedlot 78  707957    9076     NaN    NaN\nResiduals     0       0     NaN               \n\n # Pg. 73\n emmeans(object = fm5.4, specs = ~ site)\n site       emmean  SE df lower.CL upper.CL\n Ratchaburi    462 NaN  0      NaN      NaN\n Sai Thong     628 NaN  0      NaN      NaN\n Si Sa Ket     494 NaN  0      NaN      NaN\n Sakaerat      370 NaN  0      NaN      NaN\n\nResults are averaged over the levels of: seedlot \nConfidence level used: 0.95 \n\n emmeans(object = fm5.4, specs = ~ seedlot)\n seedlot emmean  SE df lower.CL upper.CL\n 13877      365 NaN  0      NaN      NaN\n 13866      353 NaN  0      NaN      NaN\n 13689      559 NaN  0      NaN      NaN\n 13688      546 NaN  0      NaN      NaN\n 13861      627 NaN  0      NaN      NaN\n 13854      628 NaN  0      NaN      NaN\n 13684      660 NaN  0      NaN      NaN\n 13864      422 NaN  0      NaN      NaN\n 13863      586 NaN  0      NaN      NaN\n 13683      770 NaN  0      NaN      NaN\n 13681      695 NaN  0      NaN      NaN\n 14175      438 NaN  0      NaN      NaN\n 14660      521 NaN  0      NaN      NaN\n 13653      592 NaN  0      NaN      NaN\n 13846      440 NaN  0      NaN      NaN\n 13621      384 NaN  0      NaN      NaN\n 13871      272 NaN  0      NaN      NaN\n 13519      422 NaN  0      NaN      NaN\n 13514      369 NaN  0      NaN      NaN\n 13148      273 NaN  0      NaN      NaN\n 13990      282 NaN  0      NaN      NaN\n 14537      780 NaN  0      NaN      NaN\n 14106      772 NaN  0      NaN      NaN\n 12013      616 NaN  0      NaN      NaN\n 14130      422 NaN  0      NaN      NaN\n 14485      123 NaN  0      NaN      NaN\n 11935      273 NaN  0      NaN      NaN\n\nResults are averaged over the levels of: site \nConfidence level used: 0.95 \n\n ANOVAfm5.4 &lt;- anova(fm5.4)\n\n ANOVAfm5.4[4, 1:3] &lt;- c(208, 208*1040, 1040)\n\n ANOVAfm5.4[3, 4]   &lt;- ANOVAfm5.4[3, 3]/ANOVAfm5.4[4, 3]\n\n ANOVAfm5.4[3, 5]   &lt;-\n            pf(\n               q        = ANOVAfm5.4[3, 4]\n           , df1        = ANOVAfm5.4[3, 1]\n           , df2        = ANOVAfm5.4[4, 1]\n           , lower.tail = FALSE\n           )\n\n # Pg. 73\n ANOVAfm5.4\nAnalysis of Variance Table\n\nResponse: ht\n              Df  Sum Sq Mean Sq F value                Pr(&gt;F)    \nsite           3  919585  306528     NaN                   NaN    \nseedlot       26 3176289  122165     NaN                   NaN    \nsite:seedlot  78  707957    9076  8.7273 &lt; 0.00000000000000022 ***\nResiduals    208  216320    1040                                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n # Pg. 80\n DataExam5.1 %&gt;%\n   filter(seedlot %in% c(\"13653\", \"13871\")) %&gt;%\n   ggplot(\n     data = .\n   , mapping = aes(\n                   x     = sitemean\n                 , y     = ht\n                 , color = seedlot\n                 , shape = seedlot\n                 )\n   ) +\n   geom_point() +\n   geom_smooth(\n      method    = lm\n    , se        = FALSE\n    , fullrange = TRUE\n    ) +\n   theme_classic() +\n   labs(\n       x = \"SiteMean\"\n     , y = \"SeedLot Mean\"\n     )\n\n\n\n\n\n\n\n\n\n\n Tab5.10 &lt;-\n   DataExam5.1 %&gt;%\n   summarise(Mean = mean(ht), .by = seedlot) %&gt;%\n   left_join(\n      DataExam5.1 %&gt;%\n      nest_by(seedlot) %&gt;%\n      mutate(fm1 = list(lm(ht ~ sitemean, data = data))) %&gt;%\n      summarise(Slope = coef(fm1)[2])\n   , by = \"seedlot\"\n      )\n\n # Pg. 81\n Tab5.10\n   seedlot   Mean      Slope\n1    11935 272.75 0.53017435\n2    14485 123.00 0.10170020\n3    14130 422.25 0.54976906\n4    12013 616.25 2.06723798\n5    14106 771.75 1.37751724\n6    14537 779.75 0.96012145\n7    13990 281.75 0.08298796\n8    13148 273.25 0.05333546\n9    13514 368.75 0.12307233\n10   13519 422.00 0.29211648\n11   13871 271.50 0.83048203\n12   13621 383.75 1.20085607\n13   13846 440.00 0.70691001\n14   13653 591.50 1.59434380\n15   14660 521.25 0.93353990\n16   14175 438.00 1.33770745\n17   13681 695.00 1.30937837\n18   13683 769.75 1.79629735\n19   13863 586.25 1.48034730\n20   13864 422.50 0.61113857\n21   13684 660.00 1.67860570\n22   13854 628.00 1.62026853\n23   13861 626.75 1.43784662\n24   13688 546.50 1.72717652\n25   13689 558.75 1.19475332\n26   13866 352.75 0.61009734\n27   13877 364.75 0.79221858\n\n ggplot(data = Tab5.10, mapping = aes(x = Mean, y = Slope)) +\n  geom_point(size = 2) +\n  theme_bw() +\n  labs(\n      x = \"SeedLot Mean\"\n    , y = \"Regression Coefficient\"\n    )\n\n\n\n\n\n\n\n\n\n\n DevSS1 &lt;-\n   DataExam5.1 %&gt;%\n   nest_by(seedlot) %&gt;%\n   mutate(fm1 = list(lm(ht ~ sitemean, data = data))) %&gt;%\n   summarise(SSE = anova(fm1)[2, 2]) %&gt;%\n   ungroup() %&gt;%\n   summarise(Dev = sum(SSE)) %&gt;%\n   as.numeric()\n\n ANOVAfm5.4[2, 2]\n[1] 3176289\n\n length(levels(DataExam5.1$SeedLot))\n[1] 0\n\n ANOVAfm5.4.1 &lt;-\n   rbind(\n    ANOVAfm5.4[1:3, ]\n   , c(\n       ANOVAfm5.4[2, 1]\n     , ANOVAfm5.4[3, 2] - DevSS1\n     , (ANOVAfm5.4[3, 2] - DevSS1)/ANOVAfm5.4[2, 1]\n     , NA\n     , NA\n     )\n   , c(\n       ANOVAfm5.4[3, 1]-ANOVAfm5.4[2, 1]\n     , DevSS1\n     , DevSS1/(ANOVAfm5.4[3, 1]-ANOVAfm5.4[2, 1])\n     , DevSS1/(ANOVAfm5.4[3, 1]-ANOVAfm5.4[2, 1])/ANOVAfm5.4[4, 3]\n     , pf(\n             q = DevSS1/(ANOVAfm5.4[3, 1]-ANOVAfm5.4[2, 1])/ANOVAfm5.4[4, 3]\n         , df1 = ANOVAfm5.4[3, 1]-ANOVAfm5.4[2, 1]\n         , df2 = ANOVAfm5.4[4, 1]\n         , lower.tail = FALSE\n         )\n     )\n   , ANOVAfm5.4[4, ]\n   )\n\n rownames(ANOVAfm5.4.1) &lt;-\n   c(\n     \"Site\"\n   , \"seedlot\"\n   , \"site:seedlot\"\n   , \"  regressions\"\n   , \"  deviations\"\n   , \"Residuals\"\n   )\n\n # Pg. 82\n ANOVAfm5.4.1\nAnalysis of Variance Table\n\nResponse: ht\n               Df  Sum Sq Mean Sq F value                Pr(&gt;F)    \nSite            3  919585  306528     NaN                   NaN    \nseedlot        26 3176289  122165     NaN                   NaN    \nsite:seedlot   78  707957    9076  8.7273 &lt; 0.00000000000000022 ***\n  regressions  26  308503   11866                                  \n  deviations   52  399454    7682  7.3863 &lt; 0.00000000000000022 ***\nResiduals     208  216320    1040                                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Analysis Across Sites</span>"
    ]
  },
  {
    "objectID": "Ch05.html#example-5.2-pg.-72",
    "href": "Ch05.html#example-5.2-pg.-72",
    "title": "5  Analysis Across Sites",
    "section": "5.2 Example 5.2 (Pg. 72)",
    "text": "5.2 Example 5.2 (Pg. 72)\n\n\n\n\n\n\nExample 5.2 (Pg. 72)\n\n\n\n\n\n\n library(car)\n\n library(dae)\n\n library(dplyr)\n\n library(emmeans)\n\n library(ggplot2)\n\n library(lmerTest)\n\n library(magrittr)\n\n library(predictmeans)\n\n data(DataExam5.2)\n\n # Pg. 75\n fm5.7 &lt;-\n  lm(\n      formula = ht ~ site*seedlot\n    , data    = DataExam5.2\n    )\n\n # Pg. 77\n anova(fm5.7)\nAnalysis of Variance Table\n\nResponse: ht\n              Df  Sum Sq Mean Sq F value Pr(&gt;F)\nsite           5 4157543  831509     NaN    NaN\nseedlot       36 4425296  122925     NaN    NaN\nsite:seedlot 150 1351054    9007     NaN    NaN\nResiduals      0       0     NaN               \n\n fm5.9 &lt;-\n  lm(\n      formula = ht ~ site*seedlot\n    , data    = DataExam5.2\n    )\n\n # Pg. 77\n anova(fm5.9)\nAnalysis of Variance Table\n\nResponse: ht\n              Df  Sum Sq Mean Sq F value Pr(&gt;F)\nsite           5 4157543  831509     NaN    NaN\nseedlot       36 4425296  122925     NaN    NaN\nsite:seedlot 150 1351054    9007     NaN    NaN\nResiduals      0       0     NaN               \n\n ANOVAfm5.9 &lt;- anova(fm5.9)\n\n ANOVAfm5.9[4, 1:3] &lt;- c(384, 384*964, 964)\n\n ANOVAfm5.9[3, 4]   &lt;- ANOVAfm5.9[3, 3]/ANOVAfm5.9[4, 3]\n\n ANOVAfm5.9[3, 5]   &lt;-\n     pf(\n         q = ANOVAfm5.9[3, 4]\n     , df1 = ANOVAfm5.9[3, 1]\n     , df2 = ANOVAfm5.9[4, 1]\n     , lower.tail = FALSE\n     )\n\n # Pg. 77\n ANOVAfm5.9\nAnalysis of Variance Table\n\nResponse: ht\n              Df  Sum Sq Mean Sq F value                Pr(&gt;F)    \nsite           5 4157543  831509     NaN                   NaN    \nseedlot       36 4425296  122925     NaN                   NaN    \nsite:seedlot 150 1351054    9007  9.3434 &lt; 0.00000000000000022 ***\nResiduals    384  370176     964                                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n Tab5.14 &lt;-\n   DataExam5.2 %&gt;%\n   summarise(\n        Mean = round(mean(ht, na.rm = TRUE), 0)\n      , .by  = seedlot\n      ) %&gt;%\n    left_join(\n       DataExam5.2 %&gt;%\n       nest_by(seedlot) %&gt;%\n       mutate(fm2 = list(lm(ht ~ sitemean, data = data))) %&gt;%\n       summarise(Slope = round(coef(fm2)[2], 2))\n     , by = \"seedlot\"\n      ) %&gt;%\n   as.data.frame()\n\n # Pg. 81\n Tab5.14\n   seedlot Mean Slope\n1    13877  291  0.80\n2    13866  302  0.56\n3    13689  463  1.07\n4    13688  458  1.20\n5    13861  538  1.08\n6    13854  536  1.16\n7    13686  726  1.77\n8    13684  549  1.34\n9    13864  371  0.79\n10   13863  586  1.19\n11   13683  673  1.78\n12   13681  610  1.33\n13   13680  645  2.08\n14   14623  652  0.49\n15   14175  378  1.22\n16   14660  445  0.88\n17   13691  511  1.61\n18   13653  477  1.35\n19   13846  381  0.93\n20   13621  304  0.98\n21   14176  177  0.22\n22   13871  220  0.64\n23   14622  355  1.65\n24   13876  240  0.77\n25   13519  342  0.71\n26   13514  290  0.66\n27   13148  230  0.35\n28   13990  260  0.29\n29   14537  671  1.15\n30   14106  673  1.18\n31   12013  529  1.30\n32   14130  390  0.45\n33   14485  108  0.16\n34   14166  210  0.61\n35   11935  211  0.61\n36   14170  244  0.59\n37   14152  150  0.63\n\n DevSS2 &lt;-\n   DataExam5.2 %&gt;%\n   nest_by(seedlot) %&gt;%\n   mutate(fm2 = list(lm(ht ~ sitemean, data = data))) %&gt;%\n   summarise(SSE = anova(fm2)[2, 2]) %&gt;%\n   ungroup() %&gt;%\n   summarise(Dev = sum(SSE)) %&gt;%\n   as.numeric()\n\n ANOVAfm5.9.1 &lt;-\n   rbind(\n      ANOVAfm5.9[1:3, ]\n    , c(\n         ANOVAfm5.9[2, 1]\n       , ANOVAfm5.9[3, 2] - DevSS2\n       , (ANOVAfm5.9[3, 2] - DevSS2)/ANOVAfm5.9[2, 1]\n       , NA\n       , NA\n       )\n    , c(\n         ANOVAfm5.9[3, 1]-ANOVAfm5.9[2, 1]\n       , DevSS2\n       , DevSS2/(ANOVAfm5.9[3, 1]-ANOVAfm5.9[2, 1])\n       , DevSS2/(ANOVAfm5.9[3, 1]-ANOVAfm5.9[2, 1])/ANOVAfm5.9[4, 3]\n       , pf(\n               q = DevSS2/(ANOVAfm5.9[3, 1]-ANOVAfm5.9[2, 1])/ANOVAfm5.9[4, 3]\n           , df1 = ANOVAfm5.9[3, 1]-ANOVAfm5.9[2, 1]\n           , df2 = ANOVAfm5.9[4, 1]\n           , lower.tail = FALSE\n           )\n       )\n    , ANOVAfm5.9[4, ]\n   )\n\n rownames(ANOVAfm5.9.1) &lt;-\n   c(\n      \"site\"\n    , \"seedlot\"\n    , \"site:seedlot\"\n    , \"  regressions\"\n    , \"  deviations\"\n    , \"Residuals\"\n    )\n\n # Pg. 82\n ANOVAfm5.9.1\nAnalysis of Variance Table\n\nResponse: ht\n               Df  Sum Sq Mean Sq F value                Pr(&gt;F)    \nsite            5 4157543  831509     NaN                   NaN    \nseedlot        36 4425296  122925     NaN                   NaN    \nsite:seedlot  150 1351054    9007  9.3434 &lt; 0.00000000000000022 ***\n  regressions  36  703203   19533                                  \n  deviations  114  647851    5683  5.8951 &lt; 0.00000000000000022 ***\nResiduals     384  370176     964                                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n Code &lt;-\n  c(\n    \"a\",\"a\",\"a\",\"a\",\"b\",\"b\",\"b\",\"b\"\n  , \"c\",\"d\",\"d\",\"d\",\"d\",\"e\",\"f\",\"g\"\n  , \"h\",\"h\",\"i\",\"i\",\"j\",\"k\",\"l\",\"m\"\n  ,\"n\",\"n\",\"n\",\"o\",\"p\",\"p\",\"q\",\"r\"\n  , \"s\",\"t\",\"t\",\"u\",\"v\"\n  )\n\n Tab5.14$Code &lt;- Code\n\n ggplot(\n    data = Tab5.14\n  , mapping = aes(x = Mean, y = Slope)\n  ) +\n  geom_point(size = 2) +\n  geom_text(\n     mapping = aes(label = Code)\n   , hjust   = -0.5\n   , vjust   = -0.5\n  ) +\n  theme_bw() +\n  labs(\n      x = \"SeedLot Mean\"\n    , y = \"Regression Coefficient\"\n    )",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Analysis Across Sites</span>"
    ]
  },
  {
    "objectID": "Ch06.html",
    "href": "Ch06.html",
    "title": "6  Variance Components and Genetics Concepts",
    "section": "",
    "text": "6.1 Example 6.2 (Pg. 90)",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Variance Components and Genetics Concepts</span>"
    ]
  },
  {
    "objectID": "Ch06.html#example-6.2-pg.-90",
    "href": "Ch06.html#example-6.2-pg.-90",
    "title": "6  Variance Components and Genetics Concepts",
    "section": "",
    "text": "Example 6.2 (Pg. 90)\n\n\n\nA progeny trial of Acacia mangium was planted at Segaluid, Sabah, by the Sabah Forest Research Centre in 1994. The trial was designed to test 48 open-pollinated families collected from natural provenances in Papua New Guinea (PNG, 41 families) and far north Queensland (five families) and two families of the land race that had developed in Sabah after introduction of A. mangium in the 1960s. Based on the results of many previous trials (Harwood & Williams 1992), it was expected that the Sabah and Queensland families would perform more poorly than those from PNG. The trial was set out as an RCB design with four replicates each containing 48 five-tree plots. Spacing was 3m \\(\\times\\) 3m between trees, and an external perimeter row surrounded the trial. Diameter at breast height (dbh) and height (ht) measurements were taken in 1997, 36 months after planting.\n\n\n\n library(car)\n\n library(dae)\n\n library(dplyr)\n\n library(emmeans)\n\n library(ggplot2)\n\n library(lmerTest)\n\n library(magrittr)\n\n library(predictmeans)\n\n data(DataExam6.2)\n\n DataExam6.2.1 &lt;-\n     DataExam6.2 %&gt;%\n     filter(Province == \"PNG\")\n\n # Pg. 94\n fm6.3 &lt;-\n      lm(\n           formula = Dbh.mean ~ Replication + Family\n         , data    = DataExam6.2.1\n        )\n\n b    &lt;- anova(fm6.3)\n\n HM      &lt;- function(x){length(x)/sum(1/x)}\n\n w       &lt;- HM(DataExam6.2.1$Dbh.count)\n\n S2      &lt;- b[[\"Mean Sq\"]][length(b[[\"Mean Sq\"]])]\n\n Sigma2t &lt;- mean(DataExam6.2.1$Dbh.variance)\n\n sigma2m &lt;- S2-(Sigma2t/w)\n\n fm6.3.1 &lt;-\n   lmer(\n       formula = Dbh.mean ~ 1 + Replication + (1|Family)\n     , data    = DataExam6.2.1\n     , REML    = TRUE\n     )\n\n # Pg. 104\n # summary(fm6.3.1)\n varcomp(fm6.3.1)\n                     vcov     SE  2.5 % 97.5 %\nFamily.(Intercept) 0.2584 0.1286 0.0538 0.5767\nresidual           1.1667 0.1506 0.8954 1.4774\n\n sigma2f &lt;- 0.2584\n\n h2 &lt;- (sigma2f/(0.3))/(Sigma2t + sigma2m + sigma2f)\n\n cbind(hmean = w, Sigma2t, sigma2m, sigma2f, h2)\n        hmean  Sigma2t   sigma2m sigma2f        h2\n[1,] 4.408602 3.920732 0.2773606  0.2584 0.1932761\n\n fm6.4 &lt;-\n   lm(\n       formula = Dbh.mean ~ Replication+Family\n      , data   = DataExam6.2\n      )\n\n b    &lt;- anova(fm6.4)\n\n HM      &lt;- function(x){length(x)/sum(1/x)}\n\n w       &lt;- HM(DataExam6.2$Dbh.count)\n\n S2      &lt;- b[[\"Mean Sq\"]][length(b[[\"Mean Sq\"]])]\n\n Sigma2t &lt;- mean(DataExam6.2$Dbh.variance)\n\n sigma2m &lt;- S2-(Sigma2t/w)\n\n fm6.4.1 &lt;-\n  lmer(\n    formula = Dbh.mean ~ 1 + Replication + Province + (1|Family)\n  , data    = DataExam6.2\n  , REML    = TRUE\n     )\n\n # Pg. 107\n varcomp(fm6.4.1)\n                     vcov     SE  2.5 % 97.5 %\nFamily.(Intercept) 0.3514 0.1358 0.1203 0.6361\nresidual           1.0951 0.1304 0.8584 1.3634\n\n sigma2f &lt;- 0.3514\n\n h2 &lt;- (sigma2f/(0.3))/(Sigma2t+sigma2m+sigma2f)\n\n cbind(hmean = w, Sigma2t, sigma2m, sigma2f, h2)\n        hmean  Sigma2t  sigma2m sigma2f        h2\n[1,] 4.451314 3.860156 0.227873  0.3514 0.2638477\n\n fm6.7.1 &lt;-\n  lmer(\n    formula = Dbh.mean ~ 1+Replication+(1|Family)\n  , data    = DataExam6.2.1\n  , REML = TRUE\n  )\n\n # Pg. 116\n varcomp(fm6.7.1)\n                     vcov     SE  2.5 % 97.5 %\nFamily.(Intercept) 0.2584 0.1286 0.0538 0.5767\nresidual           1.1667 0.1506 0.8954 1.4774\n\n sigma2f[1] &lt;- 0.2584\n\n fm6.7.2&lt;-\n  lmer(\n    formula = Ht.mean ~ 1 + Replication + (1|Family)\n  , data    = DataExam6.2.1\n  , REML    = TRUE\n    )\n\n # Pg. 116\n varcomp(fm6.7.2)\n                     vcov     SE  2.5 % 97.5 %\nFamily.(Intercept) 0.2711 0.1243 0.0743 0.5794\nresidual           1.0549 0.1362 0.8097 1.3359\n\n sigma2f[2] &lt;- 0.2711\n\n fm6.7.3 &lt;-\n  lmer(\n    formula = Sum.means ~ 1 + Replication + (1|Family)\n  , data    = DataExam6.2.1\n  , REML    = TRUE\n  , control = lmerControl()\n  )\n\n # Pg. 116\n varcomp(fm6.7.3)\n                     vcov     SE  2.5 % 97.5 %\nFamily.(Intercept) 0.8729 0.3907 0.2553 1.8421\nresidual           3.2428 0.4186 2.4888 4.1063\n\n sigma2f[3] &lt;- 0.873\n\n sigma2xy   &lt;- 0.5*(sigma2f[3]-sigma2f[1]-sigma2f[2])\n\n GenCorr &lt;- sigma2xy/sqrt(sigma2f[1]*sigma2f[2])\n\n cbind(\n      S2x = sigma2f[1]\n    , S2y = sigma2f[2]\n    , S2.x.plus.y = sigma2f[3]\n    , GenCorr\n    )\n        S2x    S2y S2.x.plus.y   GenCorr\n[1,] 0.2584 0.2711       0.873 0.6489119",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Variance Components and Genetics Concepts</span>"
    ]
  },
  {
    "objectID": "Ch08.html",
    "href": "Ch08.html",
    "title": "8  Analysis of Generalized Lattice Designs",
    "section": "",
    "text": "8.1 Example 8.1 (Pg. 139)",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Analysis of Generalized Lattice Designs</span>"
    ]
  },
  {
    "objectID": "Ch08.html#example-8.1-pg.-139",
    "href": "Ch08.html#example-8.1-pg.-139",
    "title": "8  Analysis of Generalized Lattice Designs",
    "section": "",
    "text": "Example 8.1 (Pg. 139)\n\n\n\nIn the early 1990s Khongsak Pinyopusarerk of CSIRO Forestry and Forest Products initiated a far-reaching study of Casuarina equisetifolia. This is a nitrogen-fixing tree of considerable social, economic and environmental importance in tropical/subtropical littoral zones of Asia, the Pacific and Africa. Provenance collections were obtained from 18 countries and, with this material, more than 40 trials were laid out in 20 countries. The number of seedlots included in each trial varied, depending on the suitability and size of the planting sites for the available material. One of the trials, in Weipa, northern Queensland, contained all the available seedlots and is the example used here.\n\n\n\n library(car)\n\n library(dae)\n\n library(dplyr)\n\n library(emmeans)\n\n library(ggplot2)\n\n library(lmerTest)\n\n library(magrittr)\n\n library(predictmeans)\n\n data(DataExam8.1)\n\n # Pg. 141\n fm8.4 &lt;-\n   aov(\n     formula = dbh ~ inoc + Error(repl/inoc) +\n                     inoc*country*prov\n   , data    = DataExam8.1\n      )\n\n # Pg. 150\n summary(fm8.4)\n\nError: repl\n          Df Sum Sq Mean Sq F value Pr(&gt;F)  \ninoc       1 11.542  11.542   11.46 0.0773 .\nResiduals  2  2.014   1.007                 \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nError: Within\n              Df Sum Sq Mean Sq F value       Pr(&gt;F)    \ncountry       17  54.62   3.213   5.305 0.0000000159 ***\nprov          41  18.61   0.454   0.749        0.854    \ninoc:country  17  10.07   0.592   0.978        0.487    \ninoc:prov     41  21.46   0.523   0.864        0.698    \nResiduals    116  70.26   0.606                         \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n # Pg. 150\n model.tables(x = fm8.4, type = \"means\")\nTables of means\nGrand mean\n        \n3.40411 \n\n inoc \n    7 weeks  1 week\n      3.625   3.183\nrep 118.000 118.000\n\n country \n     India Vietnam  Egypt  Kenya   Fiji Thailand Malaysia Philippines Australia\n     3.575   3.276  2.498  3.491  2.612    3.841    4.031       3.612     2.631\nrep 24.000  20.000 12.000 32.000 12.000   16.000   36.000      12.000    16.000\n     PNG Solomon Is. Mauritius Sri Lanka  Guam  China Puerto Rico Vanuatu Benin\n    3.65       3.699     3.122     3.243 2.342  3.686       3.345   2.762 3.342\nrep 4.00       8.000     4.000    12.000 4.000 12.000       4.000   4.000 4.000\n\n prov \n        1     2    3    4     5     6     7     8    10    11   12   13    14\n    2.623 4.013 3.71 3.27 3.404 3.093 3.701 3.541 3.371 3.301 3.18 3.37 3.404\nrep 4.000 4.000 4.00 4.00 4.000 4.000 4.000 4.000 4.000 4.000 4.00 4.00 4.000\n       15   16    17    18   19    20    21   22   23    24    25    26   27\n    3.595 3.43 3.275 3.085 3.66 3.382 3.235 3.46 3.08 3.555 3.918 3.648 3.43\nrep 4.000 4.00 4.000 4.000 4.00 4.000 4.000 4.00 4.00 4.000 4.000 4.000 4.00\n       28    29    30    31    32    33    34    35    36    37    38   39   40\n    2.905 3.708 3.196 3.761 3.416 3.178 2.958 3.636 3.376 3.404 3.252 3.15 3.81\nrep 4.000 4.000 4.000 4.000 4.000 4.000 4.000 4.000 4.000 4.000 4.000 4.00 4.00\n       41    42    45   46    47    48    50    51    52    53    54   55    56\n    3.195 3.613 3.518 2.76 3.733 3.605 3.404 3.685 3.235 3.755 3.605 2.74 3.662\nrep 4.000 4.000 4.000 4.00 4.000 4.000 4.000 4.000 4.000 4.000 4.000 4.00 4.000\n       57    58    59    60    61    62    63\n    3.408 3.404 3.404 3.528 3.178 3.506 3.418\nrep 4.000 4.000 4.000 4.000 4.000 4.000 4.000\n\n inoc:country \n         country\ninoc      India  Vietnam Egypt  Kenya  Fiji   Thailand Malaysia Philippines\n  7 weeks  3.672  3.443   2.747  3.609  2.955  3.611    4.502    3.558     \n  rep     12.000 10.000   6.000 16.000  6.000  8.000   18.000    6.000     \n  1 week   3.477  3.110   2.250  3.373  2.268  4.071    3.559    3.665     \n  rep     12.000 10.000   6.000 16.000  6.000  8.000   18.000    6.000     \n         country\ninoc      Australia PNG    Solomon Is. Mauritius Sri Lanka Guam   China \n  7 weeks  2.959     3.850  4.200       3.390     3.695     2.245  4.030\n  rep      8.000     2.000  4.000       2.000     6.000     2.000  6.000\n  1 week   2.304     3.450  3.197       2.855     2.792     2.440  3.342\n  rep      8.000     2.000  4.000       2.000     6.000     2.000  6.000\n         country\ninoc      Puerto Rico Vanuatu Benin \n  7 weeks  3.540       2.720   3.870\n  rep      2.000       2.000   2.000\n  1 week   3.150       2.805   2.815\n  rep      2.000       2.000   2.000\n\n inoc:prov \n         prov\ninoc      1     2     3     4     5     6     7     8     10    11    12   \n  7 weeks 2.427 4.682 3.757 3.637 3.625 3.540 4.100 3.774 3.559 3.544 3.135\n  rep     2.000 2.819 3.344 3.664 2.904 3.183 2.646 3.301 3.308 3.183 3.058\n  1 week  2.819 3.344 3.664 2.904 3.183 2.646 3.301 3.308 3.183 3.058 3.225\n  rep     2.427 4.682 3.757 3.637 3.625 3.540 4.100 3.774 3.559 3.544 3.135\n         prov\ninoc      13    14    15    16    17    18    19    20    21    22    23   \n  7 weeks 3.845 3.625 4.104 4.119 3.604 3.114 3.509 3.304 3.591 3.801 3.276\n  rep     3.225 2.895 3.183 3.085 2.740 2.945 3.055 3.810 3.460 2.880 3.120\n  1 week  2.895 3.183 3.085 2.740 2.945 3.055 3.810 3.460 2.880 3.120 2.885\n  rep     3.845 3.625 4.104 4.119 3.604 3.114 3.509 3.304 3.591 3.801 3.276\n         prov\ninoc      24    25    26    27    28    29    30    31    32    33    34   \n  7 weeks 3.021 3.976 4.286 4.186 2.866 3.663 2.988 3.793 4.358 3.343 3.468\n  rep     2.885 4.090 3.860 3.010 2.675 2.945 3.754 3.404 3.729 2.474 3.014\n  1 week  4.090 3.860 3.010 2.675 2.945 3.754 3.404 3.729 2.474 3.014 2.449\n  rep     3.021 3.976 4.286 4.186 2.866 3.663 2.988 3.793 4.358 3.343 3.468\n         prov\ninoc      35    36    37    38    39    40    41    42    45    46    47   \n  7 weeks 3.848 3.688 3.625 3.772 3.132 3.972 3.545 3.705 3.439 2.599 4.119\n  rep     2.449 3.424 3.064 3.183 2.733 3.168 3.648 2.845 3.520 3.597 2.922\n  1 week  3.424 3.064 3.183 2.733 3.168 3.648 2.845 3.520 3.597 2.922 3.347\n  rep     3.848 3.688 3.625 3.772 3.132 3.972 3.545 3.705 3.439 2.599 4.119\n         prov\ninoc      48    50    51    52    53    54    55    56    57    58    59   \n  7 weeks 4.344 3.625 4.137 4.152 4.047 3.167 2.622 3.895 3.478 3.625 3.625\n  rep     3.347 2.867 3.183 3.233 2.318 3.463 4.043 2.858 3.430 3.339 3.183\n  1 week  2.867 3.183 3.233 2.318 3.463 4.043 2.858 3.430 3.339 3.183 3.183\n  rep     4.344 3.625 4.137 4.152 4.047 3.167 2.622 3.895 3.478 3.625 3.625\n         prov\ninoc      60    61    62    63   \n  7 weeks 3.685 3.630 3.560 3.235\n  rep     3.183 3.371 2.726 3.451\n  1 week  3.371 2.726 3.451 3.601\n  rep     3.685 3.630 3.560 3.235\n\n RESFit &lt;-\n     data.frame(\n       fittedvalue   = fitted.aovlist(fm8.4)\n     , residualvalue = proj(fm8.4)$Within[,\"Residuals\"]\n     )\n\n ggplot(\n    data    =  RESFit\n  , mapping = aes(x = fittedvalue, y = residualvalue)\n  ) +\n geom_point(size = 2) +\n labs(\n    x = \"Residuals vs Fitted Values\"\n  , y = \"\"\n  ) +\n theme_bw()\n\n\n\n\n\n\n\n\n\n\n # Pg. 153\n fm8.6 &lt;-\n  aov(\n    formula = terms(\n                    dbh ~ inoc + repl + col +\n                          repl:row + repl:col +\n                          prov + inoc:prov\n                    , keep.order = TRUE\n                    )\n  , data   = DataExam8.1\n  )\n\n summary(fm8.6)\n            Df Sum Sq Mean Sq F value               Pr(&gt;F)    \ninoc         1  11.54  11.542  48.054        0.00000000327 ***\nrepl         2   2.01   1.007   4.193             0.019746 *  \ncol          9  65.24   7.249  30.182 &lt; 0.0000000000000002 ***\nrepl:row    20  16.59   0.830   3.454             0.000105 ***\nrepl:col    27  16.41   0.608   2.530             0.001443 ** \nprov        58  53.89   0.929   3.869        0.00000026687 ***\ninoc:prov   58   8.47   0.146   0.608             0.970544    \nResiduals   60  14.41   0.240                                 \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Analysis of Generalized Lattice Designs</span>"
    ]
  },
  {
    "objectID": "Ch08.html#example-8.1-continued-pg.-147",
    "href": "Ch08.html#example-8.1-continued-pg.-147",
    "title": "8  Analysis of Generalized Lattice Designs",
    "section": "8.2 Example 8.1 (continued) (Pg. 147)",
    "text": "8.2 Example 8.1 (continued) (Pg. 147)\n\n\n\n\n\n\nExample 8.1 (continued) (Pg. 147)\n\n\n\n\n\n\n library(car)\n\n library(dae)\n\n library(dplyr)\n\n library(emmeans)\n\n library(ggplot2)\n\n library(lmerTest)\n\n library(magrittr)\n\n library(predictmeans)\n\n data(DataExam8.1)\n\n # Pg. 155\n fm8.8 &lt;-\n  lmerTest::lmer(\n      formula = dbh ~ 1 + repl + col + prov +\n                      (1|repl:row) + (1|repl:col)\n    , data   = DataExam8.1\n    , REML   = TRUE\n    )\n\n # Pg. 157\n #\\dontrun{\n varcomp(fm8.8)\n                       vcov     SE  2.5 % 97.5 %\nrepl:col.(Intercept) 0.0459 0.0262 0.0000 0.0565\nrepl:row.(Intercept) 0.0640 0.0294 0.0210 0.1161\nresidual             0.1951 0.0253 0.1126 0.1782\n\n #}\n \n anova(fm8.8)\nType III Analysis of Variance Table with Satterthwaite's method\n     Sum Sq Mean Sq NumDF   DenDF F value              Pr(&gt;F)    \nrepl  2.581 0.86023     3  21.257  4.4082             0.01469 *  \ncol  24.874 2.76378     9  23.705 14.1627 0.00000015112494790 ***\nprov 55.433 0.95574    58 136.623  4.8976 0.00000000000001306 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n anova(fm8.8, ddf = \"Kenward-Roger\")\nType III Analysis of Variance Table with Kenward-Roger's method\n     Sum Sq Mean Sq NumDF   DenDF F value             Pr(&gt;F)    \nrepl  2.580 0.86016     3  22.622  4.4078             0.0139 *  \ncol  24.824 2.75827     9  22.947 14.1337 0.0000002097637857 ***\nprov 54.795 0.94473    58 133.852  4.8396 0.0000000000000283 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n predictmeans(model = fm8.8, modelterm = \"repl\")\n\n\n$`Predicted Means`\nrepl\n     1      2      3      4 \n3.7543 3.1269 3.2128 3.5023 \n\n$`Standard Error of Means`\nAll means have the same SE \n                   0.13629 \n\n$`Standard Error of Differences`\n  Max.SED   Min.SED  Aveg.SED \n0.1927495 0.1927423 0.1927472 \n\n$LSD\n Max.LSD  Min.LSD Aveg.LSD \n 0.39910  0.39909  0.39910 \nattr(,\"Significant level\")\n[1] 0.05\nattr(,\"Degree of freedom\")\n[1] 22.62\n\n$mean_table\n  repl   Mean      SE      Df LL(95%) UL(95%)\n1    1 3.7543 0.13629 22.6214  3.4721  4.0365\n2    2 3.1269 0.13629 22.6214  2.8447  3.4091\n3    3 3.2128 0.13629 22.6214  2.9306  3.4950\n4    4 3.5023 0.13629 22.6214  3.2201  3.7845\n\n\n predictmeans(model = fm8.8, modelterm = \"col\")\n\n\n$`Predicted Means`\ncol\n     1      2      3      4      5      6      7      8      9     10 \n3.5053 3.4996 3.8509 3.8280 3.5947 3.7829 3.3059 3.5158 3.1776 1.9301 \n\n$`Standard Error of Means`\ncol\n      1       2       3       4       5       6       7       8       9      10 \n0.15496 0.15649 0.15493 0.15494 0.15490 0.15721 0.15479 0.15699 0.15485 0.15648 \n\n$`Standard Error of Differences`\n  Max.SED   Min.SED  Aveg.SED \n0.2132295 0.2061223 0.2086161 \n\n$LSD\n Max.LSD  Min.LSD Aveg.LSD \n 0.43742  0.42284  0.42796 \nattr(,\"Significant level\")\n[1] 0.05\nattr(,\"Degree of freedom\")\n[1] 27.12\n\n$mean_table\n   col   Mean      SE       Df LL(95%) UL(95%)\n1    1 3.5053 0.15496 27.11736  3.1874  3.8232\n2    2 3.4996 0.15649 27.11736  3.1786  3.8207\n3    3 3.8509 0.15493 27.11736  3.5330  4.1687\n4    4 3.8280 0.15494 27.11736  3.5101  4.1458\n5    5 3.5947 0.15490 27.11736  3.2769  3.9125\n6    6 3.7829 0.15721 27.11736  3.4604  4.1054\n7    7 3.3059 0.15479 27.11736  2.9883  3.6234\n8    8 3.5158 0.15699 27.11736  3.1938  3.8379\n9    9 3.1776 0.15485 27.11736  2.8599  3.4952\n10  10 1.9301 0.15648 27.11736  1.6091  2.2511\n\n\n predictmeans(model = fm8.8, modelterm = \"prov\")\n\n\n$`Predicted Means`\nprov\n     1      2      3      4      5      6      7      8     10     11     12 \n2.4222 3.1425 2.8646 2.2599 3.7189 3.5445 3.9474 2.7469 2.6459 2.0497 2.7497 \n    13     14     15     16     17     18     19     20     21     22     23 \n2.9833 2.6534 3.4459 3.9209 3.4294 3.3624 3.6540 3.3685 3.2210 3.3315 3.2453 \n    24     25     26     27     28     29     30     31     32     33     34 \n3.6933 3.8460 3.5233 3.5271 3.1001 3.8997 3.5447 4.1294 4.2755 3.7429 3.8890 \n    35     36     37     38     39     40     41     42     45     46     47 \n4.1179 3.8526 3.4538 3.0379 3.5306 3.7412 3.7422 3.8765 4.2126 3.4660 4.4688 \n    48     50     51     52     53     54     55     56     57     58     59 \n3.7503 2.5571 3.4571 3.3227 3.5926 3.5337 2.7157 2.7702 3.9805 2.9968 3.3978 \n    60     61     62     63 \n3.0115 3.2238 3.2814 3.5751 \n\n$`Standard Error of Means`\nprov\n      1       2       3       4       5       6       7       8      10      11 \n0.25362 0.25446 0.25278 0.25443 0.25423 0.25588 0.25420 0.25338 0.25417 0.25259 \n     12      13      14      15      16      17      18      19      20      21 \n0.25306 0.25436 0.25259 0.25232 0.25502 0.25319 0.25340 0.25309 0.25294 0.25204 \n     22      23      24      25      26      27      28      29      30      31 \n0.25350 0.25355 0.25358 0.25316 0.25289 0.25294 0.25291 0.25341 0.25254 0.25330 \n     32      33      34      35      36      37      38      39      40      41 \n0.25377 0.25387 0.25510 0.25347 0.25351 0.25352 0.25416 0.25393 0.25450 0.25416 \n     42      45      46      47      48      50      51      52      53      54 \n0.25303 0.25257 0.25323 0.25316 0.25356 0.25354 0.25372 0.25361 0.25237 0.25321 \n     55      56      57      58      59      60      61      62      63 \n0.25374 0.25639 0.25173 0.25319 0.25250 0.25303 0.25378 0.25266 0.25500 \n\n$`Standard Error of Differences`\n  Max.SED   Min.SED  Aveg.SED \n0.3591712 0.3326719 0.3482665 \n\n$LSD\n Max.LSD  Min.LSD Aveg.LSD \n 0.70924  0.65691  0.68770 \nattr(,\"Significant level\")\n[1] 0.05\nattr(,\"Degree of freedom\")\n[1] 162.73\n\n$mean_table\n   prov   Mean      SE       Df LL(95%) UL(95%)\n1     1 2.4222 0.25362 162.7269  1.9214  2.9230\n2     2 3.1425 0.25446 162.7269  2.6401  3.6450\n3     3 2.8646 0.25278 162.7269  2.3655  3.3638\n4     4 2.2599 0.25443 162.7269  1.7575  2.7623\n5     5 3.7189 0.25423 162.7269  3.2169  4.2209\n6     6 3.5445 0.25588 162.7269  3.0392  4.0498\n7     7 3.9474 0.25420 162.7269  3.4454  4.4493\n8     8 2.7469 0.25338 162.7269  2.2466  3.2473\n9    10 2.6459 0.25417 162.7269  2.1440  3.1478\n10   11 2.0497 0.25259 162.7269  1.5509  2.5485\n11   12 2.7497 0.25306 162.7269  2.2500  3.2494\n12   13 2.9833 0.25436 162.7269  2.4810  3.4855\n13   14 2.6534 0.25259 162.7269  2.1546  3.1522\n14   15 3.4459 0.25232 162.7269  2.9476  3.9441\n15   16 3.9209 0.25502 162.7269  3.4173  4.4245\n16   17 3.4294 0.25319 162.7269  2.9294  3.9293\n17   18 3.3624 0.25340 162.7269  2.8620  3.8628\n18   19 3.6540 0.25309 162.7269  3.1543  4.1538\n19   20 3.3685 0.25294 162.7269  2.8690  3.8680\n20   21 3.2210 0.25204 162.7269  2.7234  3.7187\n21   22 3.3315 0.25350 162.7269  2.8310  3.8321\n22   23 3.2453 0.25355 162.7269  2.7447  3.7460\n23   24 3.6933 0.25358 162.7269  3.1926  4.1941\n24   25 3.8460 0.25316 162.7269  3.3461  4.3459\n25   26 3.5233 0.25289 162.7269  3.0239  4.0227\n26   27 3.5271 0.25294 162.7269  3.0276  4.0265\n27   28 3.1001 0.25291 162.7269  2.6007  3.5996\n28   29 3.8997 0.25341 162.7269  3.3993  4.4001\n29   30 3.5447 0.25254 162.7269  3.0460  4.0434\n30   31 4.1294 0.25330 162.7269  3.6293  4.6296\n31   32 4.2755 0.25377 162.7269  3.7744  4.7766\n32   33 3.7429 0.25387 162.7269  3.2416  4.2442\n33   34 3.8890 0.25510 162.7269  3.3853  4.3928\n34   35 4.1179 0.25347 162.7269  3.6174  4.6185\n35   36 3.8526 0.25351 162.7269  3.3520  4.3532\n36   37 3.4538 0.25352 162.7269  2.9532  3.9544\n37   38 3.0379 0.25416 162.7269  2.5360  3.5398\n38   39 3.5306 0.25393 162.7269  3.0291  4.0320\n39   40 3.7412 0.25450 162.7269  3.2386  4.2437\n40   41 3.7422 0.25416 162.7269  3.2403  4.2440\n41   42 3.8765 0.25303 162.7269  3.3769  4.3761\n42   45 4.2126 0.25257 162.7269  3.7139  4.7114\n43   46 3.4660 0.25323 162.7269  2.9660  3.9661\n44   47 4.4688 0.25316 162.7269  3.9689  4.9687\n45   48 3.7503 0.25356 162.7269  3.2496  4.2510\n46   50 2.5571 0.25354 162.7269  2.0564  3.0577\n47   51 3.4571 0.25372 162.7269  2.9561  3.9582\n48   52 3.3227 0.25361 162.7269  2.8219  3.8235\n49   53 3.5926 0.25237 162.7269  3.0943  4.0910\n50   54 3.5337 0.25321 162.7269  3.0337  4.0337\n51   55 2.7157 0.25374 162.7269  2.2146  3.2167\n52   56 2.7702 0.25639 162.7269  2.2640  3.2765\n53   57 3.9805 0.25173 162.7269  3.4834  4.4776\n54   58 2.9968 0.25319 162.7269  2.4968  3.4968\n55   59 3.3978 0.25250 162.7269  2.8992  3.8963\n56   60 3.0115 0.25303 162.7269  2.5118  3.5112\n57   61 3.2238 0.25378 162.7269  2.7227  3.7250\n58   62 3.2814 0.25266 162.7269  2.7825  3.7803\n59   63 3.5751 0.25500 162.7269  3.0716  4.0787\n\n\n  # Pg. 161\n   RCB1 &lt;-\n         aov(dbh ~ prov + repl, data = DataExam8.1)\n\n   RCB  &lt;-\n         emmeans(RCB1,  specs = \"prov\") %&gt;%\n         as_tibble()\n\n   Mixed &lt;-\n           emmeans(fm8.8, specs = \"prov\") %&gt;%\n           as_tibble()\n\n   table8.9 &lt;-\n       left_join(\n          x      = RCB\n        , y      = Mixed\n        , by     = \"prov\"\n        , suffix = c(\".RCBD\", \".Mixed\")\n        )\n\n   print(table8.9)\n# A tibble: 59 × 11\n   prov  emmean.RCBD SE.RCBD df.RCBD lower.CL.RCBD upper.CL.RCBD emmean.Mixed\n   &lt;fct&gt;       &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;        &lt;dbl&gt;\n 1 1            1.85   0.382     174          1.10          2.60         2.42\n 2 2            3.24   0.382     174          2.49          3.99         3.14\n 3 3            2.94   0.382     174          2.18          3.69         2.86\n 4 4            2.50   0.382     174          1.74          3.25         2.26\n 5 5            3.34   0.382     174          2.59          4.10         3.72\n 6 6            3.37   0.382     174          2.62          4.13         3.54\n 7 7            3.98   0.382     174          3.23          4.74         3.95\n 8 8            2.63   0.382     174          1.88          3.39         2.75\n 9 10           2.47   0.382     174          1.71          3.22         2.65\n10 11           2.40   0.382     174          1.64          3.15         2.05\n# ℹ 49 more rows\n# ℹ 4 more variables: SE.Mixed &lt;dbl&gt;, df.Mixed &lt;dbl&gt;, lower.CL.Mixed &lt;dbl&gt;,\n#   upper.CL.Mixed &lt;dbl&gt;",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Analysis of Generalized Lattice Designs</span>"
    ]
  },
  {
    "objectID": "Ch08.html#example-8.1-continued-pg.-155",
    "href": "Ch08.html#example-8.1-continued-pg.-155",
    "title": "8  Analysis of Generalized Lattice Designs",
    "section": "8.3 Example 8.1 (continued) (Pg. 155)",
    "text": "8.3 Example 8.1 (continued) (Pg. 155)\n\n\n\n\n\n\nExample 8.1 (continued) (Pg. 155)\n\n\n\n\n\n\n library(car)\n\n library(dae)\n\n library(dplyr)\n\n library(emmeans)\n\n library(ggplot2)\n\n library(lmerTest)\n\n library(magrittr)\n\n library(predictmeans)\n\n data(DataExam8.1)\n\n # Pg. 167\n fm8.11 &lt;-\n   aov(\n        formula = dbh ~ country + country:prov\n      , data    = DataExam8.1\n       )\n\n   b &lt;- anova(fm8.11)\n\n   Res &lt;- length(b[[\"Sum Sq\"]])\n\n   df  &lt;- 119\n\n   MSS &lt;- 0.1951\n\n   b[[\"Df\"]][Res] &lt;- df\n\n   b[[\"Sum Sq\"]][Res] &lt;- MSS*df\n\n   b[[\"Mean Sq\"]][Res] &lt;- b[[\"Sum Sq\"]][Res]/b[[\"Df\"]][Res]\n\n   b[[\"F value\"]][1:Res-1] &lt;-\n             b[[\"Mean Sq\"]][1:Res-1]/b[[\"Mean Sq\"]][Res]\n\n   b[[\"Pr(&gt;F)\"]][Res-1] &lt;-\n      df(\n        b[[\"F value\"]][Res-1]\n      , b[[\"Df\"]][Res-1]\n      , b[[\"Df\"]][Res]\n      )\n\n   b\nAnalysis of Variance Table\n\nResponse: dbh\n              Df Sum Sq Mean Sq F value        Pr(&gt;F)    \ncountry       17 54.619  3.2129  16.468 0.00000001235 ***\ncountry:prov  41 18.606  0.4538   2.326      0.001502 ** \nResiduals    119 23.217  0.1951                          \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n  emmeans(fm8.11, specs = \"country\")\n country     emmean    SE  df lower.CL upper.CL\n India         3.57 0.165 177     3.25     3.90\n Vietnam       3.28 0.181 177     2.92     3.63\n Egypt         2.50 0.233 177     2.04     2.96\n Kenya         3.49 0.143 177     3.21     3.77\n Fiji          2.61 0.233 177     2.15     3.07\n Thailand      3.84 0.202 177     3.44     4.24\n Malaysia      4.03 0.135 177     3.77     4.30\n Philippines   3.61 0.233 177     3.15     4.07\n Australia     2.63 0.202 177     2.23     3.03\n PNG           3.65 0.404 177     2.85     4.45\n Solomon Is.   3.70 0.285 177     3.14     4.26\n Mauritius     3.12 0.404 177     2.33     3.92\n Sri Lanka     3.24 0.233 177     2.78     3.70\n Guam          2.34 0.404 177     1.55     3.14\n China         3.69 0.233 177     3.23     4.15\n Puerto Rico   3.35 0.404 177     2.55     4.14\n Vanuatu       2.76 0.404 177     1.97     3.56\n Benin         3.34 0.404 177     2.55     4.14\n\nResults are averaged over the levels of: prov \nConfidence level used: 0.95",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Analysis of Generalized Lattice Designs</span>"
    ]
  },
  {
    "objectID": "Ch08.html#example-8.2-pg.-157",
    "href": "Ch08.html#example-8.2-pg.-157",
    "title": "8  Analysis of Generalized Lattice Designs",
    "section": "8.4 Example 8.2 (Pg. 157)",
    "text": "8.4 Example 8.2 (Pg. 157)\n\n\n\n\n\n\nExample 8.2 (Pg. 157)\n\n\n\nIn Example 7.1 we discussed a Eucalyptus clone trial conducted in Vietnam and described the experimental layout. The trial tested 56 hybrid clones of the interspecific hybrid combination E. urophylla \\(\\times\\) E. pellita (UP). These candidates had been selected from progeny trials of control-pollinated hybrid families; here we ignore the parental origins of the different UP clones.\n\n\n\n library(car)\n\n library(dae)\n\n library(dplyr)\n\n library(emmeans)\n\n library(ggplot2)\n\n library(lmerTest)\n\n library(magrittr)\n\n library(predictmeans)\n\n data(DataExam8.2)\n\n # Pg.\n fm8.2  &lt;-\n   lmerTest::lmer(\n     formula = dbh ~ repl + column +\n                     contcompf + contcompf:standard +\n                     (1|repl:row) + (1|repl:column) +\n                     (1|contcompv:clone)\n   , data    = DataExam8.2\n     )\n\n #\\dontrun{\n varcomp(fm8.2)\n                              vcov     SE  2.5 % 97.5 %\ncontcompv:clone.(Intercept) 0.4950 0.1126 0.3057 0.7422\nrepl:row.(Intercept)        0.0802 0.0351 0.0173 0.1458\nrepl:column.(Intercept)     0.0529 0.0326 0.0000 0.0783\nresidual                    0.3992 0.0435 0.3245 0.5024\n\n #}\n anova(fm8.2)\nType III Analysis of Variance Table with Satterthwaite's method\n                    Sum Sq Mean Sq NumDF   DenDF F value          Pr(&gt;F)    \nrepl                3.2720  0.8180     4  26.467  2.0489       0.1162606    \ncolumn              3.1018  0.6204     5  19.545  1.5539       0.2194719    \ncontcompf           5.3203  5.3203     1  54.905 13.3265       0.0005845 ***\ncontcompf:standard 20.6587  6.8862     3 207.152 17.2488 0.0000000004896 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n Anova(fm8.2, type = \"II\", test.statistic = \"Chisq\")\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: dbh\n                     Chisq Df Pr(&gt;Chisq)    \nrepl                8.1957  4    0.08467 .  \ncolumn              7.7694  5    0.16941    \ncontcompf           4.6841  1    0.03044 *  \ncontcompf:standard 51.7463  3  3.392e-11 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n predictmeans(model = fm8.2, modelterm = \"repl\")\n\n\n$`Predicted Means`\nrepl\n     1      2      3      4      5 \n7.8926 8.2070 8.3429 8.4604 8.5464 \n\n$`Standard Error of Means`\nrepl\n      1       2       3       4       5 \n0.33123 0.33126 0.32992 0.32992 0.32992 \n\n$`Standard Error of Differences`\n  Max.SED   Min.SED  Aveg.SED \n0.2239675 0.2167320 0.2196681 \n\n$LSD\n Max.LSD  Min.LSD Aveg.LSD \n 0.44792  0.43345  0.43932 \nattr(,\"Significant level\")\n[1] 0.05\nattr(,\"Degree of freedom\")\n[1] 60.56\n\n$mean_table\n  repl   Mean      SE       Df LL(95%) UL(95%)\n1    1 7.8926 0.33123 60.55892  7.2302  8.5551\n2    2 8.2070 0.33126 60.55892  7.5445  8.8695\n3    3 8.3429 0.32992 60.55892  7.6831  9.0027\n4    4 8.4604 0.32992 60.55892  7.8006  9.1202\n5    5 8.5464 0.32992 60.55892  7.8866  9.2062\n\n\n predictmeans(model = fm8.2, modelterm = \"column\")\n\n\n$`Predicted Means`\ncolumn\n     1      2      3      4      5      6 \n8.2214 8.4708 8.3779 7.9721 7.8166 8.7141 \n\n$`Standard Error of Means`\ncolumn\n      1       2       3       4       5       6 \n0.31662 0.39168 0.39315 0.26648 0.26646 0.31653 \n\n$`Standard Error of Differences`\n  Max.SED   Min.SED  Aveg.SED \n0.2714760 0.2102583 0.2373610 \n\n$LSD\n Max.LSD  Min.LSD Aveg.LSD \n 0.54250  0.42017  0.47433 \nattr(,\"Significant level\")\n[1] 0.05\nattr(,\"Degree of freedom\")\n[1] 62.99\n\n$mean_table\n  column   Mean      SE       Df LL(95%) UL(95%)\n1      1 8.2214 0.31662 62.99437  7.5887  8.8542\n2      2 8.4708 0.39168 62.99437  7.6881  9.2535\n3      3 8.3779 0.39315 62.99437  7.5923  9.1636\n4      4 7.9721 0.26648 62.99437  7.4396  8.5047\n5      5 7.8166 0.26646 62.99437  7.2841  8.3491\n6      6 8.7141 0.31653 62.99437  8.0816  9.3467\n\n\n emmeans(object = fm8.2, specs = ~contcompf|standard)\ncontcompf = 1, standard = 0:\n emmean    SE   df lower.CL upper.CL\n   8.91 0.117 65.9     8.67     9.14\n\ncontcompf = 0, standard = UG323:\n emmean    SE   df lower.CL upper.CL\n   8.97 0.770 55.6     7.43    10.51\n\ncontcompf = 0, standard = U6:\n emmean    SE   df lower.CL upper.CL\n   6.55 0.770 55.5     5.01     8.10\n\ncontcompf = 0, standard = PN14:\n emmean    SE   df lower.CL upper.CL\n   7.70 0.771 55.8     6.16     9.25\n\ncontcompf = 0, standard = SSOseed:\n emmean    SE   df lower.CL upper.CL\n   6.08 0.770 55.5     4.54     7.63\n\nResults are averaged over the levels of: repl, column \nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Analysis of Generalized Lattice Designs</span>"
    ]
  }
]